<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Miva AI QuickNotes</title>
  <style>
    body {
      font-family: 'Inter', Arial, sans-serif;
      max-width: 800px;
      margin: 2rem auto;
      padding: 1rem;
      line-height: 1.6;
      background-color: #f8f9fa;
    }
    .container {
      background: white;
      padding: 2rem;
      border-radius: 12px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    h1 {
      color: #2c3e50;
      text-align: center;
      margin-bottom: 0.5rem;
    }
    .subtitle {
      text-align: center;
      color: #7f8c8d;
      margin-bottom: 2rem;
    }
    textarea {
      width: 100%;
      height: 200px;
      padding: 1rem;
      border: 2px solid #ecf0f1;
      border-radius: 8px;
      font-family: inherit;
      font-size: 14px;
      resize: vertical;
    }
    textarea:focus {
      outline: none;
      border-color: #3498db;
    }
    button {
      background: #3498db;
      color: white;
      padding: 12px 24px;
      margin-top: 12px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 16px;
      font-weight: 500;
    }
    button:hover {
      background: #2980b9;
    }
    button:disabled {
      background: #bdc3c7;
      cursor: not-allowed;
    }
    .output-section {
      margin-top: 2rem;
    }
    .output {
      background: #f8f9fa;
      padding: 1.5rem;
      border-radius: 8px;
      border-left: 4px solid #3498db;
    }
    .summary {
      background: #e8f5e8;
      padding: 1rem;
      border-radius: 6px;
      margin-bottom: 1rem;
      border-left: 4px solid #27ae60;
    }
    .key-points {
      background: #fff3cd;
      padding: 1rem;
      border-radius: 6px;
      margin-bottom: 1rem;
      border-left: 4px solid #f39c12;
    }
    .quiz {
      background: #e3f2fd;
      padding: 1rem;
      border-radius: 6px;
      border-left: 4px solid #2196f3;
    }
    ul {
      margin: 0.5rem 0;
      padding-left: 1.5rem;
    }
    .loading {
      text-align: center;
      color: #7f8c8d;
      font-style: italic;
    }
    .error {
      background: #ffebee;
      color: #c62828;
      padding: 1rem;
      border-radius: 6px;
      border-left: 4px solid #f44336;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üéì Miva AI QuickNotes</h1>
    <p class="subtitle">AI Study Companion for Online Lectures & PDFs</p>
    <p>Paste your lecture transcript or PDF text below and get a quick summary with key points and quiz questions.</p>
    
    <textarea id="inputText" placeholder="Paste lecture transcript or PDF extracted text here...

Example: 'In today's lecture on photosynthesis, we learned that plants convert sunlight into energy through a complex chemical process. The chloroplasts contain chlorophyll which captures light energy...'"></textarea>
    <br/>
    <button id="runBtn">üìù Generate Study Notes</button>

    <div class="output-section">
      <h3>üìã Study Notes</h3>
      <div id="output"></div>
    </div>
  </div>

  <script>
    document.getElementById("runBtn").onclick = async () => {
      const text = document.getElementById("inputText").value;
      if (!text.trim()) return alert("Please paste some text first!");
      
      const button = document.getElementById("runBtn");
      const output = document.getElementById("output");
      
      // Show loading state
      button.disabled = true;
      button.textContent = "‚è≥ Generating...";
      output.innerHTML = '<div class="loading">AI is analyzing your text and creating study notes...</div>';
      
      try {
        const res = await fetch("http://localhost:8000/summarize", {
          method: "POST",
          headers: {"Content-Type":"application/json"},
          body: JSON.stringify({text})
        });
        
        if (!res.ok) {
          throw new Error(`HTTP ${res.status}: ${res.statusText}`);
        }
        
        const data = await res.json();
        
        // Format the output nicely
        let html = '';
        
        if (data.summary) {
          html += `<div class="summary"><h4>üìù Summary</h4><p>${data.summary}</p></div>`;
        }
        
        if (data.key_points) {
          html += `<div class="key-points"><h4>üîë Key Points</h4><ul>`;
          if (Array.isArray(data.key_points)) {
            data.key_points.forEach(point => {
              html += `<li>${point}</li>`;
            });
          } else {
            html += `<li>${data.key_points}</li>`;
          }
          html += `</ul></div>`;
        }
        
        if (data.quiz_questions) {
          html += `<div class="quiz"><h4>‚ùì Quiz Questions</h4><ul>`;
          if (Array.isArray(data.quiz_questions)) {
            data.quiz_questions.forEach(question => {
              html += `<li>${question}</li>`;
            });
          } else {
            html += `<li>${data.quiz_questions}</li>`;
          }
          html += `</ul></div>`;
        }
        
        if (data.raw) {
          html += `<div class="output"><h4>üìÑ Raw Output</h4><pre>${data.raw}</pre></div>`;
        }
        
        if (!html) {
          html = '<div class="error">No structured output received. Please try again.</div>';
        }
        
        output.innerHTML = html;
        
      } catch (e) {
        output.innerHTML = `<div class="error"><strong>Error:</strong> ${e.message}<br><br><small>Make sure the backend is running on http://localhost:8000</small></div>`;
      } finally {
        // Reset button
        button.disabled = false;
        button.textContent = "üìù Generate Study Notes";
      }
    };
  </script>
</body>
</html>